# üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π

## ‚úÖ –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ: `local.properties`

**`local.properties` - –ò–î–ï–ê–õ–¨–ù–û–ï –º–µ—Å—Ç–æ –¥–ª—è API –∫–ª—é—á–µ–π!**

### –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ `local.properties`?

‚úÖ **–£–ñ–ï –≤ .gitignore** - –∫–ª—é—á–∏ –ù–ï –ø–æ–ø–∞–¥—É—Ç –≤ git  
‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç Android** - –≤—Å–µ —Ç–∞–∫ –¥–µ–ª–∞—é—Ç  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –æ–¥–∏–Ω —Ñ–∞–π–ª –¥–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤  
‚úÖ **BuildConfig** - –¥–æ—Å—Ç—É–ø –∏–∑ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã  
‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ** - –Ω–µ –Ω—É–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –∫–ª—é—á–∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑  

---

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `local.properties`

–§–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```
AIAdvent4Thread/local.properties
```

**–î–æ–±–∞–≤—å —Å–≤–æ–∏ –∫–ª—é—á–∏:**

```properties
# YandexGPT API Configuration
yandex.api.key=AQVN_—Ç–≤–æ–π_–Ω–∞—Å—Ç–æ—è—â–∏–π_–∫–ª—é—á
yandex.folder.id=b1g_—Ç–≤–æ–π_folder_id
```

### –®–∞–≥ 2: –°–æ–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç

```bash
./gradlew assembleDebug
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ú–∞–≥–∏—è!** üéâ
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –∑–∞–≥—Ä—É–∑–∏—Ç –∫–ª—é—á–∏
- **–°—Ä–∞–∑—É** –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —ç–∫—Ä–∞–Ω —á–∞—Ç–∞
- **–ù–µ –Ω—É–∂–Ω–æ** –≤–≤–æ–¥–∏—Ç—å –∫–ª—é—á–∏ –≤—Ä—É—á–Ω—É—é!

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. Gradle —á–∏—Ç–∞–µ—Ç `local.properties`

```kotlin
// app/build.gradle.kts
val properties = Properties()
val localPropertiesFile = rootProject.file("local.properties")
if (localPropertiesFile.exists()) {
    FileInputStream(localPropertiesFile).use { properties.load(it) }
}

buildConfigField("String", "YANDEX_API_KEY", "\"$apiKey\"")
buildConfigField("String", "YANDEX_FOLDER_ID", "\"$folderId\"")
```

### 2. –°–æ–∑–¥–∞–µ—Ç—Å—è `BuildConfig` –∫–ª–∞—Å—Å

```kotlin
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
object BuildConfig {
    const val YANDEX_API_KEY = "AQVN..."
    const val YANDEX_FOLDER_ID = "b1g..."
}
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–µ

```kotlin
// MainActivity.kt
App(
    defaultApiKey = BuildConfig.YANDEX_API_KEY,
    defaultFolderId = BuildConfig.YANDEX_FOLDER_ID
)
```

### 4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –∫–ª—é—á–∞–º–∏!

–ï—Å–ª–∏ –∫–ª—é—á–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã ‚Üí **—Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–∞—Ç**  
–ï—Å–ª–∏ –∫–ª—é—á–∏ –ø—É—Å—Ç—ã–µ ‚Üí **–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç–∫—Ä–∞–Ω –≤–≤–æ–¥–∞**

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:

1. **Git:** `local.properties` –≤ `.gitignore` - –ù–ï –ø–æ–ø–∞–¥–µ—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. **–°–±–æ—Ä–∫–∞:** –ö–ª—é—á–∏ —á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
3. **APK:** –ö–ª—é—á–∏ –≤ BuildConfig (–æ–±—Ñ—É—Å—Ü–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ ProGuard)
4. **–ö–æ–¥:** –ù–µ—Ç hardcoded –∫–ª—é—á–µ–π –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞—Ö

### ‚ö†Ô∏è –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å:

- **Debug APK:** –ö–ª—é—á–∏ –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–µ–π
- **Release APK:** ProGuard –æ–±—Ñ—É—Å—Ü–∏—Ä—É–µ—Ç, –Ω–æ –Ω–µ —à–∏—Ñ—Ä—É–µ—Ç
- **Production:** –ò—Å–ø–æ–ª—å–∑—É–π —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å –¥–ª—è –∫–ª—é—á–µ–π

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
AIAdvent4Thread/
‚îú‚îÄ‚îÄ local.properties              ‚úÖ –¢–í–û–ò –∫–ª—é—á–∏ (–ù–ï –≤ git)
‚îú‚îÄ‚îÄ local.properties.example      üìÑ –ü—Ä–∏–º–µ—Ä –¥–ª—è –¥—Ä—É–≥–∏—Ö
‚îú‚îÄ‚îÄ .gitignore                    üîí –ó–∞—â–∏—Ç–∞ (local.properties –≤–Ω—É—Ç—Ä–∏)
‚îî‚îÄ‚îÄ app/
    ‚îú‚îÄ‚îÄ build.gradle.kts          ‚öôÔ∏è –ß–∏—Ç–∞–µ—Ç local.properties
    ‚îî‚îÄ‚îÄ src/androidMain/
        ‚îî‚îÄ‚îÄ kotlin/.../MainActivity.kt  üì± –ò—Å–ø–æ–ª—å–∑—É–µ—Ç BuildConfig
```

---

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ó–∞–ø–æ–ª–Ω–∏ `local.properties`:**
```properties
yandex.api.key=AQVN_—Ç–≤–æ–π_–∫–ª—é—á
yandex.folder.id=b1g_—Ç–≤–æ–π_folder
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ —á–∞—Ç–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –∫–ª—é—á–∏
- ‚úÖ –£–¥–æ–±–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–π –≤–≤–æ–¥

**–û—Å—Ç–∞–≤—å –ø—É—Å—Ç—ã–º–∏ –≤ `local.properties`:**
```properties
yandex.api.key=
yandex.folder.id=
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û—Ç–∫—Ä–æ–µ—Ç—Å—è —ç–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∫–ª—é—á–µ–π
- ‚úÖ –í–≤–µ–¥–µ—à—å –∫–ª—é—á–∏ –≤—Ä—É—á–Ω—É—é
- ‚úÖ –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏/–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π

**–ó–∞–ø–æ–ª–Ω–∏ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª—é—á:**
```properties
yandex.api.key=AQVN_—Ç–≤–æ–π_–∫–ª—é—á
yandex.folder.id=
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ API –∫–ª—é—á –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω
- ‚úÖ Folder ID –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏
- ‚úÖ –î–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ `local.properties` –Ω–µ—Ç:

```bash
# –°–∫–æ–ø–∏—Ä—É–π –ø—Ä–∏–º–µ—Ä
cp local.properties.example local.properties

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π —Ñ–∞–π–ª
nano local.properties  # –∏–ª–∏ –ª—é–±—ã–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º

# –ó–∞–º–µ–Ω–∏:
yandex.api.key=AQVN_—Ç–≤–æ–π_–∫–ª—é—á
yandex.folder.id=b1g_—Ç–≤–æ–π_folder
```

### –ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –µ—Å—Ç—å:

```bash
# –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
echo "" >> local.properties
echo "yandex.api.key=AQVN_—Ç–≤–æ–π_–∫–ª—é—á" >> local.properties
echo "yandex.folder.id=b1g_—Ç–≤–æ–π_folder" >> local.properties
```

---

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

### 1. EncryptedSharedPreferences

```kotlin
val encryptedPrefs = EncryptedSharedPreferences.create(
    context,
    "secret_prefs",
    masterKey,
    EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,
    EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM
)
```

‚úÖ **–ü–ª—é—Å—ã:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ  
‚ùå **–ú–∏–Ω—É—Å—ã:** –°–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å

### 2. Backend API

```kotlin
// –ö–ª—é—á–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω
val token = backendApi.authenticate(userId)
```

‚úÖ **–ü–ª—é—Å—ã:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å  
‚ùå **–ú–∏–Ω—É—Å—ã:** –ù—É–∂–µ–Ω —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä

### 3. Android Keystore

```kotlin
val keyStore = KeyStore.getInstance("AndroidKeyStore")
// –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```

‚úÖ **–ü–ª—é—Å—ã:** –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –∑–∞—â–∏—Ç–∞  
‚ùå **–ú–∏–Ω—É—Å—ã:** –°–ª–æ–∂–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
üëâ **–ò—Å–ø–æ–ª—å–∑—É–π `local.properties`** - –ø—Ä–æ—Å—Ç–æ –∏ —É–¥–æ–±–Ω–æ

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
üëâ **–†—É—á–Ω–æ–π –≤–≤–æ–¥** - –Ω–µ —Ö—Ä–∞–Ω–∏ –∫–ª—é—á–∏ –≤ —Ñ–∞–π–ª–µ

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
üëâ **Backend API** - –∫–ª—é—á–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [x] `local.properties` –≤ `.gitignore`
- [x] –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª `local.properties.example` –±–µ–∑ –∫–ª—é—á–µ–π
- [x] –ö–ª—é—á–∏ –Ω–µ hardcoded –≤ –∫–æ–¥–µ
- [x] BuildConfig –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª—é—á–∞–º
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [x] –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

---

## üÜò –ü—Ä–æ–±–ª–µ–º—ã?

### –ö–ª—é—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è?

1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ñ–∞–π–ª –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Ç–æ—á–Ω–æ** `local.properties`
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–ª—é—á–∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç: `./gradlew clean assembleDebug`

### Git –≤–∏–¥–∏—Ç `local.properties`?

```bash
# –ü—Ä–æ–≤–µ—Ä—å .gitignore
cat .gitignore | grep local.properties

# –ï—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤—å:
echo "local.properties" >> .gitignore

# –£–¥–∞–ª–∏ –∏–∑ git (–µ—Å–ª–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω):
git rm --cached local.properties
```

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥ –∫–ª—é—á–µ–π?

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç —á—Ç–æ –∫–ª—é—á–∏ –≤ `local.properties` –ø—É—Å—Ç—ã–µ. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!
–ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥–∏ –∫–ª—é—á–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- [Android Security Best Practices](https://developer.android.com/topic/security/best-practices)
- [EncryptedSharedPreferences](https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences)
- [Yandex Cloud Security](https://cloud.yandex.ru/docs/iam/concepts/authorization/api-key)

---

**–¢–≤–æ–∏ –∫–ª—é—á–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏! üîê‚úÖ**

